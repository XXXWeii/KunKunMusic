import{_ as a}from"./album.4277e4bb.js";import{_ as e,P as s,r as l,j as t,z as r,Q as u,M as i,N as n,O as c,U as o,a9 as d,R as p,W as m,S as v,at as g,$ as h,cE as y,cF as f,bD as b,aA as k,aw as j,ay as _,ax as w,X as C,Y as q,a3 as x,a7 as S,a8 as I,aE as T,ch as N,bn as P}from"./index.2d658157.js";import{D as $}from"./DataLists.3ba2b8b8.js";import{P as D}from"./index.fe593983.js";import{_ as R}from"./Skeleton.2e7bf840.js";import"./SmallSongData.9d069edf.js";import"./InputNumber.6e3256f5.js";import"./Add.4fe37192.js";import"./FormItem.8e86c8fa.js";import"./PlayOne.a9053696.js";import"./Select.bcceca04.js";import"./use-houdini.7148f755.js";const z=a=>(S("data-v-e1f12236"),a=a(),I(),a),L={key:0,class:"playlist"},U={class:"left"},E={class:"cover"},M=z((()=>c("img",{src:a,class:"album",alt:"album"},null,-1))),A={class:"intr"},F=z((()=>c("span",{class:"name"},"歌单简介",-1))),H={class:"desc text-hidden"},O={class:"right"},Q={class:"meta"},V={class:"name"},J={class:"creator"},W={class:"time"},X={class:"createTime"},Y=z((()=>c("span",{class:"num"},"创建时间：",-1))),B={class:"updateTime"},G=z((()=>c("span",{class:"num"},"更新时间：",-1))),K={key:1,class:"title"},Z={class:"key"},aa=z((()=>c("br",null,null,-1))),ea={key:2,class:"loading"},sa={class:"left"},la={class:"right"},ta=e({__name:"PlayListView",setup(a){const e=s(),S=l(e.currentRoute.value.query.id),I=l(null),z=l([]),ta=l(!1),ra=l(30),ua=l(!0),ia=l(e.currentRoute.value.query.page?Number(e.currentRoute.value.query.page):1),na=l(0),ca=a=>{y(a).then((a=>{na.value=a.playlist.trackCount,I.value=a.playlist,$setSiteTitle(a.playlist.name+" - 歌单")})).catch((a=>{$setSiteTitle("歌单详情"),ua.value=!1,console.error("获取歌单信息失败："+a)}))},oa=(a,e=30,s=0)=>{f(a,e,s).then((e=>{e.songs?(z.value=[],e.songs.forEach(((e,s)=>{z.value.push({id:e.id,num:s+1+(ia.value-1)*ra.value,name:e.name,artist:e.ar,album:e.al,alia:e.alia,time:b(e.dt),fee:e.fee,sourceId:a,pc:e.pc?e.pc:null,mv:e.mv?e.mv:null})}))):$message.error("获取歌单内歌曲失败"),$mainContent&&$mainContent.scrollIntoView({behavior:"smooth"})}))};t((()=>{S.value&&(ca(S.value),oa(S.value,ra.value,(ia.value-1)*ra.value))}));const da=a=>{ra.value=a,oa(S.value,a,(ia.value-1)*ra.value)},pa=a=>{e.push({path:"/playlist",query:{id:S.value,page:a}})};return r((()=>e.currentRoute.value),((a,e)=>{S.value=a.query.id,ia.value=Number(a.query.page?a.query.page:1),"playlist"==a.name&&(a.query.id!=e.query.id?(ca(S.value),oa(S.value,ra.value,(ia.value-1)*ra.value)):oa(S.value,ra.value,(ia.value-1)*ra.value))})),(a,s)=>{var l,t;const r=k,y=j,f=T,b=N,ra=_,ca=P,oa=w,ma=R;return u(I)?(i(),n("div",L,[c("div",U,[c("div",E,[o(r,{class:"coverImg",src:u(I).coverImgUrl?u(I).coverImgUrl.replace(/^http:/,"https:")+"?param=1024y1024":null,"fallback-src":"/images/pic/default.png"},null,8,["src"]),M]),c("div",A,[F,c("span",H,d(u(I).description?u(I).description:"太懒了吧，连简介都不写"),1),(null==(t=null==(l=u(I))?void 0:l.description)?void 0:t.length)>70?(i(),p(y,{key:0,block:"",strong:"",secondary:"",onClick:s[0]||(s[0]=a=>ta.value=!0)},{default:m((()=>[h(" 全部简介 ")])),_:1})):v("",!0),o(ra,{class:"s-modal",show:u(ta),"onUpdate:show":s[1]||(s[1]=a=>g(ta)?ta.value=a:null),preset:"card",title:"歌单简介",bordered:!1},{default:m((()=>[o(b,null,{default:m((()=>[o(f,{innerHTML:u(I).description.replace(/\n/g,"<br>")},null,8,["innerHTML"])])),_:1})])),_:1},8,["show"])]),u(I).tags?(i(),p(oa,{key:0,class:"tag"},{default:m((()=>[(i(!0),n(C,null,q(u(I).tags,(a=>(i(),p(ca,{class:"tags",size:"large",round:"",bordered:!1,key:a,onClick:s=>u(e).push(`/discover/playlists?cat=${a}&page=1`)},{default:m((()=>[h(d(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})):v("",!0)]),c("div",O,[c("div",Q,[c("span",V,d(u(I).name),1),c("span",J,d(u(I).creator.nickname),1),c("div",W,[c("div",X,[Y,h(" "+d(u(x)(u(I).createTime)),1)]),c("div",B,[G,h(" "+d(u(x)(u(I).updateTime)),1)])])]),o($,{listData:u(z)},null,8,["listData"]),o(D,{totalCount:u(na),pageNumber:u(ia),showSizePicker:!1,showQuickJumper:!1,onPageSizeChange:da,onPageNumberChange:pa},null,8,["totalCount","pageNumber"])])])):u(S)&&u(ua)?(i(),n("div",ea,[c("div",sa,[o(ma,{class:"pic"}),o(ma,{text:"",repeat:5}),o(ma,{text:"",style:{width:"60%"}})]),c("div",la,[o(ma,{sharp:!1,height:"80px",width:"60%"}),o(ma,{height:"100%",width:"100%"})])])):(i(),n("div",K,[c("span",Z,d(u(ua)?"参数不完整":"歌单信息加载失败"),1),aa,o(y,{strong:"",secondary:"",onClick:s[2]||(s[2]=a=>u(e).go(-1)),style:{"margin-top":"20px"}},{default:m((()=>[h(" 返回上一页 ")])),_:1})]))}}},[["__scopeId","data-v-e1f12236"]]);export{ta as default};
